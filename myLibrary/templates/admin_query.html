<!--
    功能：emoji状态查询
    TODO:
    1. 输入框的变量要进行适配（例如：value="{{ book_name }}" autofocus name="book_name"
    2. 前端加载的book_status变量是views.py里admin_query函数产生的book_status变量，可以由这个逻辑链去改后端
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="../../static/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/dashboard.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="../../static/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../static/zico/JS/zico.min.js"></script>
    <script>
        $(function () {
            $('#alert').alert()
        })
    </script>
    <title> 管理员书目状态查询 </title>
</head>
<body>
<!--顶部栏-->
<nav class="navbar navbar-dark sticky-top flex-md-nowrap p-0 shadow" style="background-color: #29abff;">
    <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" href="/admin_index/"
       style="font-weight: bold;font-size: x-large;">图书管理系统</a>
    <span style="font-size: medium; color: #ffffff; margin-top: 0px; font-weight: bold;font-size: large;">管理员系统：欢迎  {{ name }}</span>
    <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap">
            <a class="nav-link" href="/logout_view/" style="font-weight: bold;color: #ffffff">退出登录</a>
        </li>
    </ul>
</nav>

<div class="container-fluid">
    <div class="row">
        <!--侧边栏-->
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="sidebar-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_index/">
                            <i class="zi zi_service"></i>
                            <span>管理员主界面</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_query/">
                            <i class="zi zi_search"></i>
                            <span>emoji状态查询</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_borrow/">
                            <i class="zi zi_squareDown"></i>
                            <span>用户状态查询</span>
                        </a>
                    </li>
                        <!--
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_return/">
                            <i class="zi zi_squareUp"></i>
                            <span>还书</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_upload/">
                            <i class="zi zi_squarePlus"></i>
                            <span>入库</span>
                        </a>
                    </li>
            -->
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_takeoff/">
                            <i class="zi zi_squareLess"></i>
                            <span>用户注销</span>
                        </a>
                    </li>
                <!--
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_pay/">
                            <i class="zi zi_yensign"></i>
                            <span>为读者缴费/扣费</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin_recommend/">
                            <i class="zi zi_bell"></i>
                            <span>处理读者荐购</span>
                        </a>
                    </li>
                    -->
                </ul>
            </div>
        </nav>
    </div>
</div>
<main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">emoji状态查询</h1>
    </div>
    <form role="form" action="/admin_query/" method="post">
        {% csrf_token %}
        <div class="form-group row">
            <label for="book_name" class="col-md-1 col-form-label">名称</label>
            <div class="col-book_name-3">
                <input name="book_name" type="text" class="form-control" id="book_name" placeholder=""
                       value="{{ book_name }}" autofocus name="book_name">
            </div>
            <label for="isbn" class="col-md-1 col-form-label"> emoji号 </label>
            <div class="col-book_name-3">
                <input name="isbn" type="text" class="form-control" id="isbn" placeholder="" value="{{ isbn }}">
            </div>
        </div>
        <button class="btn btn-primary"> 查询</button>
    </form>
    <br>
    {% if request.method == 'POST' %}
    {% if not book_status %}
    <div class="alert alert-warning alert-dismissible fade show" role="alert" style="display: inline-block">
        未找到匹配信息！
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% else %}
    <table class="table mt-3 table-hover" style="font-size: medium">
        <thead class="thead-light">
        <tr>
            <th scope="col"> emoji号</th>
            <th scope="col"> 名称</th>
            <th scope="col" nowrap="true"> 发送总人数</th>
            <th scope="col" nowrap="true"> 发送总次数</th>
            <th scope="col" nowrap="true"> 过去七天的发送人数</th>
            <th scope="col" nowrap="true"> 过去七天的发送次数</th>
        </tr>
        </thead>
        <tbody>
        {% for elem in book_status %}
        <tr>
            <td nowrap="true"> {{ elem.ISBN }}</td>
            <td nowrap="true"><a href="/libadmin/book/{{ elem.ISBN }}/">{{ elem.book_name }}</a></td>
            <td align='center' style="font-weight: bold"> {{ elem.num_inlib }}</td>
            <td align='center' style="font-weight: bold"> {{ elem.num_forbid_borrow }}</td>
            <td align='center' style="font-weight: bold"> {{ elem.num_not_borrow }}</td>
            <td align='center' style="font-weight: bold"> {{ elem.num_have_borrow }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% endif %}
</main>
</div>
</div>
</body>
</html>
<style>
    body {
        background-image: url("../../static/img/background-o.jpg");
        background-size: cover;
        width: 100%;
        height: 100%;
        position: absolute;
        background-repeat: no-repeat;
        background-attachment: fixed;
    }
</style>
